{% extends '_base.html' %}
{% load static %}

{% block customstyle %}
<link rel="stylesheet" href="{% static 'css/checkout.css' %}">
{% endblock customstyle %}

{% block title %}Register{% endblock %}

{% block content %}
<!--================Login Box Area =================-->
<section class="login_box_area section_gap">
    <div class="container">
        <div class="row">
            <div class="col-lg-6">
                <div class="login_box_img">
                    <img class="img-fluid" src="{% static 'img/blog/blog-7.jpg' %}" alt="">
                    <div class="hover">
                        <h4>New to {{ APP_NAME }}</h4>
                        <p>There are advances being made in science and technology everyday, and a good example of this is the</p>
                        <a class="btn custom-background" href="{% url 'app:login_page' %}">Create an Account</a>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="login_form_inner">
                    <h3>Create Account</h3>
                    <form class="row login_form"  method="post" id="registration-form">
                        {% csrf_token %}
                        <div id="registration-errors" class="col-md-12 form-group text-danger"></div>
                        <div class="col-md-12 form-group">
                            <input type="text" class="form-control" id="firstName" name="firstName" placeholder="First Name" onfocus="this.placeholder = ''" onblur="this.placeholder = 'First Name'" required>
                        </div>
                        <div class="col-md-12 form-group">
                            <input type="text" class="form-control" id="lastName" name="lastName" placeholder="Last Name" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Last Name'" required>
                        </div>
                        <div class="col-md-12 form-group">
                            <input type="email" class="form-control" id="email" name="email" placeholder="Email Address" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Email Address'" required>
                        </div>
                        <div class="col-md-12 form-group">
                            <input type="password" class="form-control" id="password" name="password" placeholder="Password" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Password'" required>
                        </div>
                        <div class="col-md-12 form-group">
                            <input type="password" class="form-control" id="cmfpassword" name="cmfpassword" placeholder="Confirm Password" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Confirm Password'" required>
                        </div>
                        <div class="col-md-12 form-group">
                            <button type="submit" value="submit" class="btn custom-outline-background w-75">Register</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>
<!--================End Login Box Area =================-->
{% endblock %}

{% block javascript %}
<script>
    $(document).ready(function() {
        $('#registration-form').submit(function(event) {
            event.preventDefault(); // Prevent default form submission
    
            var formData = $(this).serialize(); // Serialize form data
            var url = "{% url 'app:handleUserRegistration' %}"; // URL for registration handler
    
            // AJAX request
            $.ajax({
                type: 'POST',
                url: url,
                data: formData,
                dataType: 'json', // Expect JSON response
                success: function(response) {
                    if (response.success) {
                        location.href = "{% url 'app:home_page' %}"
                    } else {
                        // Display error message(s)
                        $('#registration-errors').text(response.message);
                    }
                },
                error: function() {
                    // Handle AJAX request error
                    $('#registration-errors').text('An error occurred. Please try again.');
                }
            });
        });
    });
    </script>
{% endblock javascript %}